; PHP-FPM havuzu: WordPress için FPM süreçleri ve kaynak ayarları
[www]
; PHP-FPM süreçlerinin çalışacağı kullanıcı/grup (WordPress dosyalarıyla uyumlu)
user = www-data
group = www-data
; FPM'in dinleyeceği adres: Tüm arayüzlerde 9000 (NGINX bu porta bağlanır)
listen = 0.0.0.0:9000

; Process Manager (PM) modu ve kaynak sınırları
pm = dynamic
pm.max_children = 5           ; Aynı anda çalışabilecek en fazla FPM child sayısı
pm.start_servers = 2          ; Başlangıçta açılacak süreç sayısı
pm.min_spare_servers = 1      ; Minimum boşta süreç sayısı
pm.max_spare_servers = 3      ; Maksimum boşta süreç sayısı

; Güvenlik ve kararlılık
clear_env = no                ; Ortam değişkenlerini koru (WP-CLI ve env için gerekli)
pm.max_requests = 500         ; Bir child’ın yeniden başlatılmadan önce işleyeceği istek limiti
request_terminate_timeout = 60s ; Uzun süren istekleri 60 sn sonra sonlandır
catch_workers_output = yes    ; Çalışan çıktısını logla (hata ayıklama yardımcı)

; WordPress için makul PHP sınırları
php_admin_value[upload_max_filesize] = 64M
php_admin_value[post_max_size] = 64M
php_admin_value[memory_limit] = 256M
php_admin_value[max_execution_time] = 120
php_admin_value[date.timezone] = Europe/Istanbul
